from fastapi import FastAPI # importamos el API
from pydantic import BaseModel
from typing import List
import pickle # importamos la librería para cargar el modelo

class ApiInput(BaseModel):
    Novedad_M: List[float]
    Novedad_N: List[float]
    Marca_ACURA: List[float]
    Marca_AG: List[float]
    Marca_AGRALE: List[float]
    Marca_AKT: List[float]
    Marca_ALEKO: List[float]
    Marca_ALFA_ROMEO: List[float]
    Marca_AMC: List[float]
    Marca_AMPLE: List[float]
    Marca_APRILIA: List[float]
    Marca_ARCTIC_CAT: List[float]
    Marca_AROCARPATI: List[float]
    Marca_ASIA: List[float]
    Marca_ATM: List[float]
    Marca_AUDI: List[float]
    Marca_AUPACO: List[float]
    Marca_AUTECO: List[float]
    Marca_AYCO: List[float]
    Marca_BAIC: List[float]
    Marca_BAW: List[float]
    Marca_BENELLI: List[float]
    Marca_BMW: List[float]
    Marca_BORGO: List[float]
    Marca_BRILLIANCE: List[float]
    Marca_BRP_CAN_AM: List[float]
    Marca_BUICK: List[float]
    Marca_BYD: List[float]
    Marca_CADILLAC: List[float]
    Marca_CAGIVA: List[float]
    Marca_CHANA: List[float]
    Marca_CHANGAN: List[float]
    Marca_CHANGFENG: List[float]
    Marca_CHANGHE: List[float]
    Marca_CHERY: List[float]
    Marca_CHEVROLET: List[float]
    Marca_CHRYSLER: List[float]
    Marca_CITROEN: List[float]
    Marca_CMC: List[float]
    Marca_DACIA: List[float]
    Marca_DADI: List[float]
    Marca_DAEWOO: List[float]
    Marca_DAF: List[float]
    Marca_DAIHATSU: List[float]
    Marca_DAYANG: List[float]
    Marca_DERBI: List[float]
    Marca_DFAC: List[float]
    Marca_DFSK_DFM_DFZL: List[float]
    Marca_DINA: List[float]
    Marca_DODGE: List[float]
    Marca_DONGBEN: List[float]
    Marca_DS: List[float]
    Marca_DUCATI: List[float]
    Marca_EAGLE_CARGO: List[float]
    Marca_EUROPAMOTOS: List[float]
    Marca_EUROSTAR_D_LONG: List[float]
    Marca_FAW_AMI: List[float]
    Marca_FERRARI: List[float]
    Marca_FIAT: List[float]
    Marca_FIRENZE: List[float]
    Marca_FORD: List[float]
    Marca_FOTON: List[float]
    Marca_FREIGHTLINER: List[float]
    Marca_FUSO: List[float]
    Marca_GEELY: List[float]
    Marca_GLOW: List[float]
    Marca_GMC: List[float]
    Marca_GOLDEN_DRAGON: List[float]
    Marca_GOMOTOR: List[float]
    Marca_GONOW: List[float]
    Marca_GREAT_WALL_MOTOR: List[float]
    Marca_GUZI: List[float]
    Marca_HAFEI: List[float]
    Marca_HAIMA: List[float]
    Marca_HAOJIANG: List[float]
    Marca_HAOJUE: List[float]
    Marca_HARLEY_DAVIDSON: List[float]
    Marca_HERO: List[float]
    Marca_HIGER: List[float]
    Marca_HINO: List[float]
    Marca_HONDA: List[float]
    Marca_HONLEI: List[float]
    Marca_HUALIN: List[float]
    Marca_HUANGHAI: List[float]
    Marca_HUMMER: List[float]
    Marca_HUSQVARNA: List[float]
    Marca_HYOSUNG: List[float]
    Marca_HYUNDAI: List[float]
    Marca_INFINITI: List[float]
    Marca_INTERNATIONAL: List[float]
    Marca_ISUZU: List[float]
    Marca_IVECO: List[float]
    Marca_JAC: List[float]
    Marca_JAGUAR: List[float]
    Marca_JAWA: List[float]
    Marca_JEEP: List[float]
    Marca_JIALING: List[float]
    Marca_JINBEI: List[float]
    Marca_JINCHENG: List[float]
    Marca_JINFENG: List[float]
    Marca_JMC: List[float]
    Marca_JOYLONG: List[float]
    Marca_KAMAZ: List[float]
    Marca_KAWASAKI: List[float]
    Marca_KAYAK: List[float]
    Marca_KAZUKI: List[float]
    Marca_KEEWAY: List[float]
    Marca_KENWORTH: List[float]
    Marca_KIA: List[float]
    Marca_KTM: List[float]
    Marca_KYMCO: List[float]
    Marca_KYOTO: List[float]
    Marca_LADA: List[float]
    Marca_LANCIA: List[float]
    Marca_LAND_ROVER: List[float]
    Marca_LANDWIND: List[float]
    Marca_LEXUS: List[float]
    Marca_LIFAN: List[float]
    Marca_LINCOLN: List[float]
    Marca_LML: List[float]
    Marca_LMX: List[float]
    Marca_MACK: List[float]
    Marca_MAHINDRA: List[float]
    Marca_MASERATI: List[float]
    Marca_MAXMOTOR: List[float]
    Marca_MAXUS: List[float]
    Marca_MAZDA: List[float]
    Marca_MD_BIKES: List[float]
    Marca_MERCEDES_BENZ: List[float]
    Marca_MERCURY: List[float]
    Marca_MG: List[float]
    Marca_MINI: List[float]
    Marca_MITSUBISHI: List[float]
    Marca_MORINI: List[float]
    Marca_MOTO_ABC: List[float]
    Marca_MOTO_GUZZI: List[float]
    Marca_MTK: List[float]
    Marca_MUDAN: List[float]
    Marca_MV_AGUSTA: List[float]
    Marca_NISSAN: List[float]
    Marca_NITRO: List[float]
    Marca_NON_PLUS_ULTRA: List[float]
    Marca_OLTCIT: List[float]
    Marca_OPEL: List[float]
    Marca_PASSAGGIO: List[float]
    Marca_PEGASO: List[float]
    Marca_PEUGEOT: List[float]
    Marca_PIAGGIO: List[float]
    Marca_POLARIS: List[float]
    Marca_PONTIAC: List[float]
    Marca_PORSCHE: List[float]
    Marca_QINGQI: List[float]
    Marca_RENAULT: List[float]
    Marca_ROVER: List[float]
    Marca_ROYAL_ENFIELD: List[float]
    Marca_SAAB: List[float]
    Marca_SACHS: List[float]
    Marca_SAICWULING: List[float]
    Marca_SANYA: List[float]
    Marca_SATURN: List[float]
    Marca_SCANIA: List[float]
    Marca_SCION: List[float]
    Marca_SCOMADI: List[float]
    Marca_SEAT: List[float]
    Marca_SHINERAY: List[float]
    Marca_SHUANGHUAN: List[float]
    Marca_SIGMA: List[float]
    Marca_SINOTRUK: List[float]
    Marca_SKODA: List[float]
    Marca_SKYGO: List[float]
    Marca_SMART: List[float]
    Marca_SMC: List[float]
    Marca_SOYAT: List[float]
    Marca_SSANGYONG: List[float]
    Marca_STEYR: List[float]
    Marca_SUBARU: List[float]
    Marca_SUKIDA: List[float]
    Marca_SUKYAMA: List[float]
    Marca_SUZUKI: List[float]
    Marca_SYM: List[float]
    Marca_T_KING: List[float]
    Marca_TATA: List[float]
    Marca_TEMPEST: List[float]
    Marca_TIANMA: List[float]
    Marca_TITANIA: List[float]
    Marca_TMD: List[float]
    Marca_TONGKO: List[float]
    Marca_TOYOTA: List[float]
    Marca_TRIUMPH: List[float]
    Marca_TVS: List[float]
    Marca_TX_MOTORS: List[float]
    Marca_UFO: List[float]
    Marca_UKM: List[float]
    Marca_UNITED_MOTORS: List[float]
    Marca_USW_MOTORS: List[float]
    Marca_VERUCCI: List[float]
    Marca_VESPA: List[float]
    Marca_VICTORY: List[float]
    Marca_VOLKSWAGEN: List[float]
    Marca_VOLVO: List[float]
    Marca_WANXIN: List[float]
    Marca_WCR: List[float]
    Marca_XIANFENG: List[float]
    Marca_XINGYUE: List[float]
    Marca_XINKAI: List[float]
    Marca_YAKEY: List[float]
    Marca_YAKIMA: List[float]
    Marca_YAMAHA: List[float]
    Marca_YAXING: List[float]
    Marca_YINGANG: List[float]
    Marca_YUEJIN_NAVECO: List[float]
    Marca_YUGO: List[float]
    Marca_YUTONG: List[float]
    Marca_ZAHAV: List[float]
    Marca_ZHONGNENG: List[float]
    Marca_ZHONGXING: List[float]
    Marca_ZNA: List[float]
    Marca_ZONGSHEN: List[float]
    Marca_ZOTYE: List[float]
    Marca_ZQ_MOTORS: List[float]
    Clase_BUS_BUSETA_MICROBUS: List[float]
    Clase_CAMION: List[float]
    Clase_CAMIONETA_PASAJ: List[float]
    Clase_CAMIONETA_REPAR: List[float]
    Clase_CAMPERO: List[float]
    Clase_CARROTANQUE: List[float]
    Clase_CHASIS: List[float]
    Clase_FURGON: List[float]
    Clase_MOTOCARRO: List[float]
    Clase_MOTOCICLETA: List[float]
    Clase_PICKUP_DOBLE_CAB: List[float]
    Clase_PICKUP_SENCILLA: List[float]
    Clase_REMOLCADOR: List[float]
    Clase_VOLQUETA: List[float]
    TipoCaja_MT: List[float]
    TipoCaja_TP: List[float]
    Nacionalidad_ARG: List[float]
    Nacionalidad_AUS: List[float]
    Nacionalidad_BRA: List[float]
    Nacionalidad_CAN: List[float]
    Nacionalidad_CHI: List[float]
    Nacionalidad_CHL: List[float]
    Nacionalidad_COL: List[float]
    Nacionalidad_CZE: List[float]
    Nacionalidad_ECU: List[float]
    Nacionalidad_ENG: List[float]
    Nacionalidad_ESP: List[float]
    Nacionalidad_FRA: List[float]
    Nacionalidad_HNG: List[float]
    Nacionalidad_IDN: List[float]
    Nacionalidad_IND: List[float]
    Nacionalidad_ITA: List[float]
    Nacionalidad_JAP: List[float]
    Nacionalidad_KOR: List[float]
    Nacionalidad_MEX: List[float]
    Nacionalidad_NED: List[float]
    Nacionalidad_RUM: List[float]
    Nacionalidad_RUS: List[float]
    Nacionalidad_SUE: List[float]
    Nacionalidad_TAI: List[float]
    Nacionalidad_TWN: List[float]
    Nacionalidad_USA: List[float]
    Nacionalidad_VEN: List[float]
    Combustible_GAS: List[float]
    Combustible_GSL: List[float]
    Combustible_HBD: List[float]
    Transmision_3X1: List[float]
    Transmision_3X2: List[float]
    Transmision_4X2: List[float]
    Transmision_4X4: List[float]
    Transmision_4x2: List[float]
    Transmision_6X2: List[float]
    Transmision_6X4: List[float]
    Transmision_6x4: List[float]
    Transmision_8X4: List[float]
    IdServicio: List[float]
    Importado: List[float]
    AireAcondicionado: List[float]
    CapacidadPasajeros: List[float]
    Puertas: List[float]
    Ejes: List[float]
    Peso: List[float]
    Potencia: List[float]
    Cilindraje: List[float]
    CapacidadCarga: List[float]


class ApiOutput(BaseModel):
    Precio2018: List[float]

app = FastAPI() # creamos el api
file_name = "../../src/nombre_paquete/models/xgb_regressor.pkl"
model = pickle.load(open(file_name, "rb"))

@app.post("/predict_vehicle_value") # creamos api que permita requests de tipo post.
async def predict_vehicle_value(data: ApiInput) -> ApiOutput:
    predictions = model.predict(data).flatten().tolist() # generamos la predicción
    preds = ApiOutput(Precio2018=predictions) # efloatucturamos la salida del API.
    return preds # retornamos los resultados
